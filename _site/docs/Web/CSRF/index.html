<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; }</style><script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico" type="image/x-icon"><title>CSRF | Cyber Grimoire</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="CSRF" /><meta property="og:locale" content="en_US" /><meta name="description" content="The Library for Cyber-Sec Knowledge" /><meta property="og:description" content="The Library for Cyber-Sec Knowledge" /><link rel="canonical" href="http://localhost:4000/docs/Web/CSRF/" /><meta property="og:url" content="http://localhost:4000/docs/Web/CSRF/" /><meta property="og:site_name" content="Cyber Grimoire" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CSRF" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"The Library for Cyber-Sec Knowledge","headline":"CSRF","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/banner.webp"}},"url":"http://localhost:4000/docs/Web/CSRF/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"><div class="site-logo" role="img" aria-label="Cyber Grimoire"></div></a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Web category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Web" class="nav-list-link">Web</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/Web/CSRF/" class="nav-list-link">CSRF</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in XSS category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Web/XSS/xss/" class="nav-list-link">XSS</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/Web/XSS/xss_DOM/" class="nav-list-link">XSS - DOM</a><li class="nav-list-item"> <a href="/docs/Web/XSS/xss_reflected/" class="nav-list-link">XSS - Reflected</a><li class="nav-list-item"> <a href="/docs/Web/XSS/xss_stored/" class="nav-list-link">XSS - Stored</a></ul></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Templates category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Templates" class="nav-list-link">Templates</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in XSS category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Templates" class="nav-list-link">XSS</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/Templates/Web%20Templates/XSS_Reflected/" class="nav-list-link">XSS - Reflected</a><li class="nav-list-item"> <a href="/docs/Templates/Web%20Templates/XSS_Test/" class="nav-list-link">XSS - Test HTML</a><li class="nav-list-item"> <a href="/docs/Templates/Web%20Templates/Testes/" class="nav-list-link">XSS - Testes</a></ul></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cyber Grimoire" aria-label="Search Cyber Grimoire" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/Web">Web</a><li class="breadcrumb-nav-list-item"><span>CSRF</span></ol></nav><div id="main-content" class="main-content"><main><h2 id="summary"> <a href="#summary" class="anchor-heading" aria-labelledby="summary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary</h2><p>Cross-Site Request Forgery (CSRF) is a web security vulnerability that forces an authenticated user to perform unwanted actions on a web application in which they are authenticated. By tricking the user into making requests, an attacker can carry out actions like changing account details or making transactions, without the user’s knowledge or intent.</p><h2 id="impact"> <a href="#impact" class="anchor-heading" aria-labelledby="impact"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Impact</h2><p>Cross-Site Request Forgery (CSRF) attacks can lead to severe consequences, such as:</p><ul><li><strong>Unauthorized Actions:</strong> Attackers can perform actions on behalf of authenticated users without their knowledge.<li><strong>Account Takeover:</strong> Attackers can change user settings, transfer funds, or modify account details.<li><strong>Data Loss:</strong> Sensitive user information could be modified or deleted.<li><strong>Privilege Escalation:</strong> In some cases, attackers could escalate privileges within the application.<li><strong>Service Disruption:</strong> Critical services or accounts may be impacted by unauthorized actions.</ul><h2 id="severity-cvss"> <a href="#severity-cvss" class="anchor-heading" aria-labelledby="severity-cvss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Severity (CVSS)</h2><p>Severity based on CVSS:</p><ul><li><strong>Base Score:</strong> Typically ranges between 6.0 (Medium) to 8.8 (High) depending on the potential impact and context.<li><strong>Attack Vector:</strong> Network<li><strong>Attack Complexity:</strong> Low<li><strong>Privileges Required:</strong> None<li><strong>User Interaction:</strong> Required (victim must interact with the malicious request, e.g., by clicking a link)</ul><h2 id="how-it-is-exploited"> <a href="#how-it-is-exploited" class="anchor-heading" aria-labelledby="how-it-is-exploited"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How it is Exploited</h2><p>Victim Authentication: The user must be logged into the target web application. Malicious Request: The attacker tricks the victim into visiting a malicious site or clicking a crafted link (via email, social engineering, etc.). Silent Action: The malicious site sends an HTTP request to the legitimate web application on behalf of the user, leveraging their active session. For example:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://victim.com/change-email?email=hacker@evil.com</span><span class="dl">"</span> <span class="o">/&gt;</span>
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unintended Action: The legitimate application, assuming the request is coming from the authenticated user, executes the action.
</code></pre></div></div><h2 id="why-it-is-vulnerable"> <a href="#why-it-is-vulnerable" class="anchor-heading" aria-labelledby="why-it-is-vulnerable"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why it is Vulnerable</h2><p>CSRF vulnerabilities arise because web applications rely on cookies for authentication. Even if a user is unaware, their browser will automatically include these cookies in every request to the application. If the application does not verify the origin or intent of requests, it blindly executes them, allowing attackers to exploit the session of authenticated users.</p><h2 id="remediation"> <a href="#remediation" class="anchor-heading" aria-labelledby="remediation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Remediation</h2><p>To protect against CSRF:</p><p>Anti-CSRF Tokens: Include unique, random tokens in forms or requests. The server should validate this token before processing the request.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">hidden</span><span class="dl">"</span> <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">csrf_token</span><span class="dl">"</span> <span class="nx">value</span><span class="o">=</span><span class="dl">"</span><span class="s2">randomlyGeneratedToken</span><span class="dl">"</span><span class="o">&gt;</span>
</code></pre></div></div><p>SameSite Cookies: Set the SameSite attribute on cookies to restrict cross-site requests.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Set</span><span class="o">-</span><span class="nx">Cookie</span><span class="p">:</span> <span class="nx">sessionId</span><span class="o">=</span><span class="nx">abc123</span><span class="p">;</span> <span class="nx">SameSite</span><span class="o">=</span><span class="nx">Strict</span><span class="p">;</span>
</code></pre></div></div><p>Double Submit Cookie: Use a CSRF token in both the cookie and request header, comparing the two on the server. Referer Validation: Ensure the Referer or Origin header matches the legitimate domain before processing requests. Limit the use of GET for State-Changing Operations: Use POST or other methods for actions that change application state.</p><h2 id="content-references"> <a href="#content-references" class="anchor-heading" aria-labelledby="content-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Content References</h2><ul><li>OWASP: Cross-Site Request Forgery (CSRF)<li>MDN Web Docs: Cross-Site Request Forgery<li>CSRF Prevention in Web Applications</ul></main><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024-2028 Cyber Grimoire. Distributed by an <a href="https://github.com/CyberGrimoire/CyberGrimoire.github.io/blob/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/just-the-docs/just-the-docs/tree/main/docs/Web/CSRF.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
